4) Employees & Chat sync
 - When clicking employee chat icon open a DM window; messages sent should appear both in the DM UI and in the team chat history.
 - Ensure messages are stored/sent to the same backend channel/store so they propagate to team chat.

Acceptance
 - Sending a DM from employee listing updates the team chat history in the shared chatbox without manual refresh.

5) Invoice CORS & Fetch errors
 - Reproduce: browser shows:
    Access to fetch at 'http://localhost:5000/api/invoices' from origin 'http://127.0.0.1:5173' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present
    Failed to load resource: net::ERR_FAILED
    hook.js:608 Error generating quotation: TypeError: Failed to fetch at handleGenerateQuotation (TaskInvoicing.tsx:69:30)
 - Fix options: enable CORS on backend (allow origin http://127.0.0.1:5173 or *) OR configure a dev proxy in the frontend (Vite proxy) and document change.
 - Ensure frontend handles fetch errors gracefully and shows user-friendly error.

Acceptance
 - Invoices endpoint accessible from the dev frontend without CORS error and handleGenerateQuotation no longer throws Failed to fetch.

6) Analytics — Employee performance
 - Fix runtime error:
    Uncaught TypeError: Cannot read properties of undefined (reading 'split') at EmployeePerformanceMetrics.tsx:31:28
 - Add defensive checks and tests for undefined data; ensure mapping code expects correct shape.
 - Fix useChat.tsx WebSocket disconnect behavior (line ~243 shows "Disconnected from chat WebSocket") — implement reconnect/backoff and expose export option for analytics.

Acceptance
 - Employee performance page loads without JS errors; splits are only called on defined strings.
 - WebSocket reconnects or shows clear UI when disconnected. Export (CSV/JSON) available.

7) Settings API & forms
 - Implement real backend integration for settings forms. Settings should be stored/retrieved as JSON.
 - Provide a settings JSON model example (see below).
 - Ensure update actions persist and frontend reflects changes in real time (broadcast via WS or update state).

Settings JSON model (example)
{
  "brand": {
    "name": "Your Company",
    "logoUrl": "https://example.com/logo.png"
  },
  "chat": {
    "enabled": true,
    "provider": "gemini",
    "geminiApiKeyEnv": "GEMINI_API_KEY"
  },
  "systemVitals": {
    "enabled": true,
    "pollIntervalSec": 5
  },
  "invoices": {
    "apiBase": "http://localhost:5000/api"
  }
}

Deliverables
 - One PR with code changes and tests.
 - Migration/deployment notes (how to configure Gemini keys, backend CORS, environment vars).
 - Minimal backend changes if needed (CORS header or small settings endpoints) or clear instructions for backend developer.
 - Short README or checklist for QA: steps to reproduce and verify each acceptance criterion.

Testing
 - Manual QA steps for each item.
 - Unit tests for critical components (search, employee metrics parsing).
 - E2E test(s) if possible that cover invoice fetch and chat open/response flow.

Communication
 - List blockers (if external Gemini access or backend changes are required).
 - If backend changes are needed and you cannot modify backend, provide a minimal proxy or dev-workaround.

Notes / Errors to include in PR description
- CORS error text and suggestion to add header: Access-Control-Allow-Origin: http://127.0.0.1:5173
- JS stack traces:
  - TaskInvoicing.tsx:69 TypeError: Failed to fetch
  - EmployeePerformanceMetrics.tsx:31 Cannot read properties of undefined (reading 'split')
  - useChat.tsx:243 Disconnected from chat WebSocket

Priority summary
1. Fix CORS & invoice fetch
2. Fix employee analytics error + WebSocket resilience
3. Fix navbar search, chat icon, and settings integration
4. Implement AI Chatbox (Gemini 2.5 Pro) and dashboard AI cards
5. Chat synchronization and export features

End.
